{% extends "layout.twig" %}

{% block content %}
    <div class="bg-white rounded shadow-sm p-4 mb-3">
        <div class="d-flex flex-column flex-md-row align-items-start align-items-md-center justify-content-between gap-3">
            <div>
                <div class="text-muted small mb-1">–ö–∞—Ä—Ç–æ—á–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞</div>
                <h1 class="h3 mb-2">{{ client.full_name }}</h1>

                <div class="d-flex flex-wrap gap-2">
                    {% if client.phone %}
                        <span class="badge text-bg-light border px-3 py-2">
              <span class="me-2">üìû</span>
              <span class="fw-semibold fs-5">{{ client.phone }}</span>
            </span>
                    {% endif %}

                    {% if client.address %}
                        <span class="badge text-bg-light border px-3 py-2">
              <span class="me-2">üìç</span>
              <span class="fw-semibold fs-5">{{ client.address }}</span>
            </span>
                    {% endif %}

                    {% if not client.phone and not client.address %}
                        <span class="text-muted">–¢–µ–ª–µ—Ñ–æ–Ω –∏ –∞–¥—Ä–µ—Å –Ω–µ —É–∫–∞–∑–∞–Ω—ã</span>
                    {% endif %}
                </div>
            </div>

            <div class="d-flex flex-wrap gap-2">
                <a class="btn btn-outline-secondary" href="/clients">–ö —Å–ø–∏—Å–∫—É</a>
                <a class="btn btn-success" href="/clients/{{ client.id }}/edit">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–∞</a>

                <form method="post"
                      action="/clients/{{ client.id }}/delete"
                      onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ ¬´{{ client.full_name }}¬ª –∏ –≤—Å–µ—Ö –µ–≥–æ –ø–∏—Ç–æ–º—Ü–µ–≤/–≤–∏–∑–∏—Ç—ã?');">
                    <button class="btn btn-danger" type="submit">–£–¥–∞–ª–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞</button>
                </form>

                <a class="btn btn-primary" href="/clients/{{ client.id }}/pets/create">+ –ü–∏—Ç–æ–º–µ—Ü</a>
            </div>
        </div>

        {% if client.notes %}
            <div class="mt-3">
                <div class="fw-semibold mb-1">–ó–∞–º–µ—Ç–∫–∏</div>
                <div class="text-break text-muted">{{ client.notes }}</div>
            </div>
        {% endif %}
    </div>

    <div class="bg-white rounded shadow-sm p-3">
        <div class="d-flex align-items-center justify-content-between mb-2">
            <h2 class="h6 mb-0">–ü–∏—Ç–æ–º—Ü—ã</h2>
            <a class="btn btn-sm btn-outline-primary" href="/clients/{{ client.id }}/pets/create">–î–æ–±–∞–≤–∏—Ç—å –ø–∏—Ç–æ–º—Ü–∞</a>
        </div>

        <div class="table-responsive">
            <table class="table table-striped mb-0 align-middle">
                <thead>
                <tr>
                    <th style="width: 70px;">ID</th>
                    <th>–ö–ª–∏—á–∫–∞</th>
                    <th>–í–∏–¥</th>
                    <th>–ü–æ—Ä–æ–¥–∞</th>
                    <th style="width: 140px;">–†–æ–∂–¥–µ–Ω–∏–µ</th>
                    <th style="width: 220px;">–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
                </thead>
                <tbody>
                {% for p in pets %}
                    <tr>
                        <td>{{ p.id }}</td>
                        <td>
                            <a href="/pets/{{ p.id }}" class="text-decoration-none">{{ p.name }}</a>
                        </td>
                        <td>{{ p.species|default('‚Äî') }}</td>
                        <td>{{ p.breed|default('‚Äî') }}</td>
                        <td>{{ p.birth_date_view ? p.birth_date_view : '‚Äî' }}</td>
                        <td>
                            <div class="d-flex gap-2">
                                <a class="btn btn-sm btn-success" href="/pets/{{ p.id }}/edit?back=/clients/{{ client.id }}">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>

                                <form method="post"
                                      action="/pets/{{ p.id }}/delete"
                                      onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å –ø–∏—Ç–æ–º—Ü–∞ ¬´{{ p.name }}¬ª –∏ –≤—Å–µ –µ–≥–æ –≤–∏–∑–∏—Ç—ã?');">
                                    <button class="btn btn-sm btn-danger" type="submit">–£–¥–∞–ª–∏—Ç—å</button>
                                </form>
                            </div>
                        </td>
                    </tr>
                {% else %}
                    <tr>
                        <td colspan="6" class="text-center text-muted py-4">–ü–∏—Ç–æ–º—Ü–µ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
{% endblock %}
